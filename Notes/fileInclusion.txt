Strong Input Validation
A whitelist of acceptable inputs
Reject any inputs that does not strictly conform to specifications
For filenames, use stringent whitelist that limits the character set to be used
Exclude directory separators such as “/”
Use a whitelist of allowable file extensions
Environment hardening
Develop and run your code in the most recent versions of PHP available
Configure your PHP applications so that it does not use register_globals
Set allow_url_fopen to false, which limits the ability to include files from remote locations
Run your code using the lowest privileges
Use a vetted library or framework that does not allow this weakness.



http://example.com/?file=../../../../etc/passwd